{
    "rules": {
        ".read": false,
        ".write": false,
        "rooms": {
            ".read": "auth != null",
            ".write": "auth != null",
            "$room_id": {
                ".validate": "newData.hasChildren(['status', 'hostId'])",
                "status": {
                    ".validate": "newData.isString()"
                },
                "roundNumber": {
                    ".validate": "newData.isNumber()"
                },
                "players": {
                    "$player_index": {
                        ".validate": "newData.hasChildren(['id', 'name'])"
                    }
                }
            },
            ".indexOn": [
                "status"
            ]
        },
        "users": {
            ".read": "auth != null",
            "$user_id": {
                ".write": "$user_id === auth.uid",
                ".validate": "newData.hasChild('username')",
                "username": {
                    ".validate": "newData.isString() && newData.val().length < 30"
                }
            },
            ".indexOn": [
                "username"
            ]
        },
        "invites": {
            ".read": "auth != null",
            "$invite_id": {
                ".write": "(data.exists() && data.child('fromUserId').val() === auth.uid) || (!data.exists() && newData.child('fromUserId').val() === auth.uid) || (data.exists() && data.child('toUserId').val() === auth.uid)", 
                ".validate": "newData.hasChildren(['fromUserId', 'toUserId', 'roomCode', 'sentAt', 'status'])"
            },
            ".indexOn": [
                "toUserId",
                "sentAt"
            ]
        },
        "friendRequests": {
            ".read": "auth != null",
            "$request_id": {
                ".write": "(!data.exists() && newData.child('fromUserId').val() === auth.uid) || (data.exists() && (data.child('toUserId').val() === auth.uid || data.child('fromUserId').val() === auth.uid))"
            },
            ".indexOn": [
                "fromUserId",
                "toUserId"
            ]
        },
        "pushTokens": {
            "$user_id": {
                ".read": "$user_id === auth.uid", 
                ".write": "$user_id === auth.uid",
                ".validate": "newData.hasChild('token')"
            }
        },
        "drawings": {
             ".read": "auth != null",
             ".write": "auth != null"
        },
        "presence": {
             ".read": "auth != null",
             ".write": "auth != null"
        }
    }
}